{% extends 'reuse/basic.html' %}

<!-- {% load static %} -->

{% block title %} SAMS Title  {% endblock %}

{% block css %}
<style>
  .content,
  .content * {
    box-sizing: border-box;
  }
  
  .content {
    padding: 40px;
    display: flex;
    flex-direction: column;
    gap: 20px;
    align-items: flex-start;
    justify-content: flex-start;
    flex: 1;
    position: relative;
    overflow: hidden;
  }
  
  .bread-crumb {
    align-self: stretch;
    flex-shrink: 0;
    height: 50px;
    position: relative;
    overflow: hidden;
  }
  
  .profile3 {
    color: #4154f1;
    text-align: left;
    font-family: "Nunito", sans-serif;
    font-size: 24px;
    line-height: 28.8px;
    font-weight: 600;
    position: absolute;
    left: 0px;
    top: 0px;
    display: flex;
    align-items: center;
    justify-content: flex-start;
  }
  
  .ol {
    display: flex;
    flex-direction: row;
    gap: 0px;
    align-items: flex-start;
    justify-content: flex-start;
    position: absolute;
    left: 0px;
    top: 28.8px;
  }
  
  .home {
    color: #989797;
    text-align: left;
    font-family: "Nunito", sans-serif;
    font-size: 14px;
    line-height: 21px;
    font-weight: 600;
    position: relative;
    display: flex;
    align-items: center;
    justify-content: flex-start;
  }
  
  .li {
    padding: 0px 0px 0px 8px;
    display: flex;
    flex-direction: row;
    gap: 7.17px;
    align-items: flex-start;
    justify-content: flex-start;
    flex-shrink: 0;
    position: relative;
  }
  
  .div {
    color: #989797;
    text-align: left;
    font-family: "Nunito", sans-serif;
    font-size: 14px;
    line-height: 21px;
    font-weight: 600;
    position: relative;
    display: flex;
    align-items: center;
    justify-content: flex-start;
  }
  
  .profile2 {
    color: #444444;
    text-align: left;
    font-family: "Nunito", sans-serif;
    font-size: 14px;
    line-height: 21px;
    font-weight: 600;
    position: relative;
    display: flex;
    align-items: center;
    justify-content: flex-start;
  }
    .course-list {
      padding: 10px 0px 10px 0px;
      display: flex;
      flex-direction: row;
      gap: 50px;
      align-items: flex-start;
      justify-content: flex-start;
      flex-wrap: wrap;
      align-content: flex-start;
      align-self: stretch;
      flex-shrink: 0;
      position: relative;
      overflow: hidden;
    }
    .student-course-card {
      background: #ffffff;
      border-radius: 5px;
      display: flex;
      flex-direction: row;
      gap: 10px;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      width: 275px;
      height: 174px;
      position: relative;
      box-shadow: 0px 0px 30px 0px rgba(1, 41, 112, 0.1);
    }
    .div2 {
      padding: 0px 20px 0px 20px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      justify-content: center; /* Center content vertically */
      align-items: center; /* Center content horizontally */
      flex: 1;
      position: static;
    }
    .course-info {
      padding: 5px;
      display: flex;
      flex-direction: row;
      gap: 10px;
      align-items: center;
      justify-content: center;
      align-self: stretch;
      flex-shrink: 0;
      height: 54px;
      position: relative;
    }
    .cs-101 {
      color: #4154f1;
      text-align: left;
      font-family: "Nunito", sans-serif;
      font-weight: 500;
      font-size: 18px;
      line-height: 21.6px;
      font-weight: 500;
      position: relative;
      width: 65px;
      display: flex;
      align-items: center;
      justify-content: flex-start;
    }
    .i {
      color: #899bbd;
      text-align: left;
      font-family: "Nunito", sans-serif;
      font-weight: 200;
      font-size: 48px;
      line-height: 21.6px;
      font-weight: 200;
      position: relative;
      width: 10px;
      display: flex;
      align-items: center;
      justify-content: flex-start;
    }
    .statistical-pattern-recognition {
      color: #899bbd;
      text-align: left;
      font-family: "Nunito", sans-serif;
      font-weight: 400;
      font-size: 14px;
      line-height: 21.6px;
      font-weight: 400;
      position: relative;
      width: 130px;
      display: flex;
      align-items: center;
      justify-content: flex-start;
    }
    .percentage {
      display: flex;
      flex-direction: row;
      gap: 15px;
      align-items: center;
      justify-content: flex-start;
      align-self: stretch;
      flex-shrink: 0;
      position: relative;
    }
    .pie {
      flex-shrink: 0;
      width: 64px;
      height: 64px;
      position: relative;
    }
    ._75 {
      color: #4154f1;
      text-align: left;
      font-family: "Nunito", sans-serif;
      font-weight: 700;
      font-size: 28px;
      line-height: 33.6px;
      font-weight: 700;
      position: relative;
      display: flex;
      align-items: center;
      justify-content: flex-start;
    }

    .total-students {
      color: #012970;
      text-align: left;
      font-family: "OpenSans-Bold", sans-serif;
      font-size: 14px;
      line-height: 21px;
      font-weight: 700;
      position: relative;
      display: flex;
      align-items: center;
      justify-content: flex-start;
    }

    .div5 {
      background: #f4f2ff;
      border-radius: 32px;
      width: 64px;
      height: 64px;
      position: absolute;
      left: 0px;
      top: calc(50% - 32px);
    }
    .div6 {
      color: #4154f1;
      text-align: left;
      font-family: "Inter-Regular", sans-serif;
      font-size: 32px;
      line-height: 32px;
      font-weight: 400;
      position: absolute;
      left: 16px;
      top: 16px;
      width: 32.2px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: flex-start;
    }
      
    .div7{
      padding: 0px 0px 0px 100px;
    }
</style>
{% endblock %}

{% block content %}

<div class="content">
  
  <div class="bread-crumb">
    <div class="profile3">Courses</div>
    <div class="ol">
        <div class="home">Track</div>
        <div class="li">
            <div class="div">/</div>
            <div class="profile2">Courses</div>
        </div>
    </div>
</div>
    
    <div class="course-list">
      {% for course in courses %}
      <!-- <a href="{% url 'teacher/courses/courses_attendance' %}"> -->
        <div class="student-course-card">
          <div class="div2">
            <div class="course-info">
              <div class="cs-101">{{ course.course_code }}</div>
              <div class="i">I</div>
              <div class="statistical-pattern-recognition">
                {{ course.course_title }}
              </div>
            </div>
            <div class="percentage">
              <!-- <canvas class="pie" id="chart-{{ forloop.counter }}"></canvas> -->
              <div class="div5">
                <div class="div6"></div>
              </div>
              <div class="div7">
                <div class="_75">{{ course.student_count }} </div>
                <div class="total-students">Total Students</div>
              </div>
            </div>
          </div>
        </div>
        </a>
      {% endfor %}
  </div>

</div>


 {% endblock %}

 {% block scripts %}
 <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
 <script>
   // Wait for the window to load before initializing the charts
   window.onload = function() {
     {% for course in courses %}
       var ctx = document.getElementById('chart-{{ forloop.counter }}').getContext('2d');
       var attendancePercentage = {{ course.attendance }};
 
       // Console log for debugging
       console.log('Initializing chart for {{ course.name }} with attendance: ' + attendancePercentage);
 
       // Create a new Chart
       new Chart(ctx, {
         type: 'doughnut',
         data: {
           labels: [], // No labels since the legend is not needed
           datasets: [{
             data: [attendancePercentage, 100 - attendancePercentage],
             backgroundColor: ['#4154f1', '#e0e0e0'], // Colors for attendance and absence
             hoverOffset: 4
           }]
         },
         options: {
           cutout: '60%', // Adjust for a donut effect
           responsive: false,
           maintainAspectRatio: false,
           plugins: {
             legend: {
               display: false // Hide the legend
             }
           }
         }
       });
     {% endfor %}
   };
 </script>
 {% endblock %}